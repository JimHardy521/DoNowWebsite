<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Practice Topic</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">

<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="common.js"></script>

<style>
body {
  font-family: 'Inter', sans-serif;
  background-color: #f0f4f8;
  color: #333;
  margin: 20px;
}

h1 {
  text-align:center;
  margin-bottom: 20px;
}

.question-box {
  border:1px solid #ccc;
  padding:10px;
  margin-bottom:10px;
  cursor:pointer;
  border-radius:6px;
  background:#fff;
  transition: background 0.2s;
}

.question-box:hover {
  background:#e0e7ff;
}

.solution {
  display:none;
  margin-top:8px;
  font-weight:500;
}
</style>
</head>
<body>

<h1 id="title">Practice Topic</h1>
<div id="questions"></div>

<script>
// ---------------- GET URL PARAMETERS ----------------
const params = new URLSearchParams(window.location.search);
const topic = params.get("topic");
const source = params.get("source"); // e.g., l2further, gcse, alevel

if (!topic || !source) {
  document.getElementById("title").textContent = "Error: Missing topic or source!";
  throw new Error("Missing topic or source in URL");
}

// ---------------- DYNAMICALLY LOAD CORRECT JS ----------------
let questionsArray;

function loadQuestionsJS(callback) {
  let src;
  switch (source) {
    case "l2further": src = "l2furtherquestions.js"; break;
    case "gcse": src = "gcsequestions.js"; break;
    case "alevel": src = "alevelquestions.js"; break;
    default: src = null;
  }
  if (!src) {
    document.getElementById("title").textContent = "Error: Unknown source!";
    return;
  }

  const script = document.createElement("script");
  script.src = src;
  script.onload = callback;
  document.head.appendChild(script);
}

// ---------------- BUILD PAGE ----------------
function buildPracticePage() {
  switch (source) {
    case "l2further": questionsArray = l2FurtherQuestions; break;
    case "gcse": questionsArray = gcseQuestions; break;
    case "alevel": questionsArray = aLevelQuestions; break;
  }

  const filtered = questionsArray.filter(q => q.topic === topic);
  if (!filtered.length) {
    document.getElementById("title").textContent = `No questions found for topic: ${topic}`;
    return;
  }

  document.getElementById("title").textContent = `Practice: ${topic}`;
  const container = document.getElementById("questions");

  filtered.forEach((q, i) => {
    const box = document.createElement("div");
    box.className = "question-box";

    const qt = document.createElement("div");
    qt.innerHTML = q.question;
    box.appendChild(qt);

    const sol = document.createElement("div");
    sol.className = "solution";
    sol.innerHTML = `<strong>Solution:</strong> ${q.solution}`;
    box.appendChild(sol);

    box.onclick = () => {
      sol.style.display = sol.style.display === "none" ? "block" : "none";
    };

    container.appendChild(box);
  });

  MathJax.typeset();
}

// ---------------- INITIALISE ----------------
loadQuestionsJS(buildPracticePage);
</script>

<script>
createNavBar("practice.html");
</script>

</body>
</html>
